{{ $currentPage := . }}
{{ $zone := index .Params.zones 0 }}

{{ if eq $zone "Guides" }}
{{ $.Scratch.Set "menuKey" .Params.Guide }}
{{ else if eq $zone "Addons" }}
{{ $.Scratch.Set "menuKey" .Params.Addon }}
{{ else }}
{{ $.Scratch.Set "menuKey" (lower $zone) }}
{{ end }}

{{ $menuKey := $.Scratch.Get "menuKey" }}
{{ if $menuKey }}
{{ $menu := index .Site.Menus $menuKey }}
{{ if $menu }}
<nav class="side-menu">
    <div class="list-group">
        <ul class="nav">
            {{ range $menu.ByWeight }}
            <li class="list-group-header">
                <a href="{{ if .HasChildren }}{{ (index .Children 0).URL }}{{ else }}{{ .URL }}{{ end }}" class="{{if or ($currentPage.IsMenuCurrent $menuKey .) ($currentPage.HasMenuCurrent $menuKey .) }} active{{end}}" data-target=".{{ .Name | urlize }}">{{ .Name | title }}</a>
            </li>
            {{ if .HasChildren }}
            <li class="list-group-item">
                <ul>
                    {{ range .Children }}
                    <li>
                        {{ .Pre }}
                        <a href="{{.URL}}" class="{{if $currentPage.IsMenuCurrent $menuKey . }}active{{end}}">
                            {{ .Name | title }}
                        </a>
                        {{ .Post }}
                    </li>
                    {{ end }}
                </ul>
            </li>
            {{end}}
            </li>
            {{end}}
        </ul>
    </div>
</nav>
{{ end }}
{{ end }}
